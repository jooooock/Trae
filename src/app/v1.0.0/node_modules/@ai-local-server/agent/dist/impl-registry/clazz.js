"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createClazzImplRegistry = createClazzImplRegistry;
const utils_1 = require("../common/utils");
const object_factory_1 = require("../impl-registry/object-factory");
function createClazzImplRegistry() {
    const clazzMap = {};
    function decorator(type) {
        return function (constructor) {
            (0, object_factory_1.ExecutionInjectable)(constructor);
            utils_1.Utils.assert(!clazzMap[type], `impl ${String(type)} already exists`);
            clazzMap[type] = constructor;
        };
    }
    const registry = {
        get: (type, ...args) => {
            const clazz = clazzMap[type];
            utils_1.Utils.assert(clazz, `impl ${String(type)} not found`);
            return object_factory_1.ObjectFactory.getObject(clazz, ...args);
        },
    };
    return [decorator, registry];
}
