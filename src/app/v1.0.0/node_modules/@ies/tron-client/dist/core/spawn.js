"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.spawn = void 0;
const child_process_1 = require("child_process");
const logger_1 = __importDefault(require("./logger"));
const spawn = (cmd, args = [], opts = {}) => {
    logger_1.default.info('spawning cmd:', cmd, 'args:', args, 'opts:', opts);
    const child = (0, child_process_1.spawn)(cmd, args, opts);
    const out = [];
    const dataHandler = (data) => out.push(data.toString());
    child.stdout.on('data', dataHandler);
    child.stderr.on('data', dataHandler);
    return new Promise((resolve, reject) => {
        child.on('error', err => {
            reject(err);
        });
        child.on('exit', code => {
            logger_1.default.info(`cmd ${cmd} terminated with code: ${code}`);
            resolve({
                code,
                output: out.join(''),
            });
        });
    });
};
exports.spawn = spawn;//# sourceMappingURL=https://trae.private/sourcemaps/424b4bd987c6c6a4cadf1a08da420593cc6bf75a/node_modules/@ies/tron-client/dist/core/spawn.js.map