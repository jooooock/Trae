import{g as e,d as n,a as t,b as r}from"./constant-DevyfzSa.js";function i(e){var n,t=e.transport,r=e.endpoint,i=e.size,o=void 0===i?10:i,a=e.wait,u=void 0===a?1e3:a,c=[],f=0;function l(){if(c.length){var e=this.getBatchData();t.post({url:r,data:e,fail:function(t){n&&n(t,e)}}),c=[]}}return{getSize:function(){return o},getWait:function(){return u},setSize:function(e){o=e},setWait:function(e){u=e},getEndpoint:function(){return r},setEndpoint:function(e){r=e},send:function(e){c.push(e),c.length>=o&&l.call(this),clearTimeout(f),f=setTimeout(l.bind(this),u)},flush:function(){clearTimeout(f),l.call(this)},getBatchData:function(){return c.length?(e=c,JSON.stringify({ev_type:"batch",list:e})):"";var e},clear:function(){clearTimeout(f),c=[]},fail:function(e){n=e}}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var o=function(){return o=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},o.apply(this,arguments)};function a(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var r,i,o=t.call(e),a=[];try{for(;(void 0===n||n-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(t=o.return)&&t.call(o)}finally{if(i)throw i.error}}return a}function u(e,n,t){if(2===arguments.length)for(var r,i=0,o=n.length;i<o;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return e.concat(r||Array.prototype.slice.call(n))}var c=["init","start","config","beforeDestroy","provide","beforeReport","report","beforeBuild","build","beforeSend","send","beforeConfig"],f=function(){return{}};function l(e){return e}function s(e){return"object"==typeof e&&null!==e}var d=Object.prototype;function v(e){return"[object Array]"===d.toString.call(e)}function p(e){return"number"==typeof e}function g(e){return"string"==typeof e}function m(e,n){if(!v(e))return!1;if(0===e.length)return!1;for(var t=0;t<e.length;){if(e[t]===n)return!0;t++}return!1}var h=function(e,n){if(!v(e))return e;var t=e.indexOf(n);if(t>=0){var r=e.slice();return r.splice(t,1),r}return e};function _(e){try{return g(e)?e:JSON.stringify(e)}catch(e){return"[FAILED_TO_STRINGIFY]:"+String(e)}}var y="".padStart?function(e,n){return void 0===n&&(n=8),e.padStart(n," ")}:function(e){return e},b=0,S=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];console.error.apply(console,u(["[SDK]",Date.now(),y(""+b++)],a(e),!1))},C=0,w=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];console.warn.apply(console,u(["[SDK]",Date.now(),y(""+C++)],a(e),!1))},E=function(e){return Math.random()<Number(e)},I=function(e,n){return e<Number(n)},R=function(e){return function(n){for(var t=n,r=0;r<e.length&&t;r++)try{t=e[r](t)}catch(e){S(e)}return t}};function D(){var e=function(){for(var e=new Array(16),n=0,t=0;t<16;t++)3&t||(n=4294967296*Math.random()),e[t]=n>>>((3&t)<<3)&255;return e}();return e[6]=15&e[6]|64,e[8]=63&e[8]|128,function(e){for(var n=[],t=0;t<256;++t)n[t]=(t+256).toString(16).substr(1);var r=0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}(e)}function x(e){var n,t,r=e.builder,i=e.createSender,o=e.createDefaultConfig,f=e.createConfigManager,l=e.userConfigNormalizer,d=e.initConfigNormalizer,v=e.validateInitConfig,p={};c.forEach((function(e){return p[e]=[]}));var g=!1,_=!1,y=!1,b=[],S=[],C=function(){var e=!1,n={},t=function(e){e.length&&e.forEach((function(e){try{e()}catch(e){}})),e.length=0},r=function(e){n[e]&&n[e].forEach((function(e){t(e[1])})),n[e]=void 0};return{set:function(r,i,o){n[r]?n[r].push([i,o]):n[r]=[[i,o]],e&&t(o)},has:function(e){return!!n[e]},remove:r,removeByEvType:function(e){Object.keys(n).forEach((function(r){n[r]&&n[r].forEach((function(n){n[0]===e&&t(n[1])}))}))},clear:function(){e=!0,Object.keys(n).forEach((function(e){r(e)}))}}}(),E={getBuilder:function(){return r},getSender:function(){return n},getPreStartQueue:function(){return b},init:function(e){if(g)w("already inited");else{if(!(e&&s(e)&&v(e)))throw new Error("invalid InitConfig, init failed");var r=o(e);if(!r)throw new Error("defaultConfig missing");var a=d(e);if((t=f(r)).setConfig(a),t.onChange((function(){I("config")})),!(n=i(t.getConfig())))throw new Error("sender missing");g=!0,I("init",!0)}},set:function(e){g&&e&&s(e)&&(I("beforeConfig",!1,e),null==t||t.setConfig(e))},config:function(e){if(g)return e&&s(e)&&(I("beforeConfig",!1,e),null==t||t.setConfig(l(e))),null==t?void 0:t.getConfig()},provide:function(e,n){m(S,e)?w("cannot provide "+e+", reserved"):(E[e]=n,I("provide",!1,e))},start:function(){var e=this;g&&(_||null==t||t.onReady((function(){_=!0,I("start",!0),b.forEach((function(n){return e.build(n)})),b.length=0})))},report:function(e){if(e){var n=R(p.beforeReport)(e);if(n){var t=R(p.report)(n);t&&(_?this.build(t):b.push(t))}}},build:function(e){if(_){var n=R(p.beforeBuild)(e);if(n){var t=r.build(n);if(t){var i=R(p.build)(t);i&&this.send(i)}}}},send:function(e){if(_){var t=R(p.beforeSend)(e);t&&(n.send(t),I("send",!1,t))}},destroy:function(){C.clear(),y=!0,b.length=0,I("beforeDestroy",!0)},on:function(e,n){if("init"===e&&g||"start"===e&&_||"beforeDestroy"===e&&y)try{n()}catch(e){}else p[e]&&p[e].push(n)},off:function(e,n){p[e]&&(p[e]=h(p[e],n))},destroyAgent:C};return S=Object.keys(E),E;function I(e,n){void 0===n&&(n=!1);for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];p[e].forEach((function(e){try{e.apply(void 0,u([],a(t),!1))}catch(e){}})),n&&(p[e].length=0)}}var A=function(e){var n=function(){var e={},n={},t={set:function(r,i){return e[r]=i,n[r]=_(i),t},merge:function(r){return e=o(o({},e),r),Object.keys(r).forEach((function(e){n[e]=_(r[e])})),t},delete:function(r){return delete e[r],delete n[r],t},clear:function(){return e={},n={},t},get:function(e){return n[e]},toString:function(){return o({},n)}};return t}();e.provide("context",n),e.on("report",(function(e){return e.extra||(e.extra={}),e.extra.context=n.toString(),e}))};var O=function(){return Date.now()};var T=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var t=function(e){if(e)return e.__SLARDAR_REGISTRY__||(e.__SLARDAR_REGISTRY__={Slardar:{plugins:[],errors:[],subject:{}}}),e.__SLARDAR_REGISTRY__.Slardar}(function(){if("object"==typeof window&&s(window))return window}());t&&(t.errors||(t.errors=[]),t.errors.push(e))},j="custom",N=function(e){e.provide("sendEvent",(function(n){var t=function(e){if(e&&s(e)&&e.name&&g(e.name)){var n={name:e.name,type:"event"};if("metrics"in e&&s(e.metrics)){var t=e.metrics,r={};for(var i in t)p(t[i])&&(r[i]=t[i]);n.metrics=r}if("categories"in e&&s(e.categories)){var o=e.categories,a={};for(var i in o)a[i]=_(o[i]);n.categories=a}return"attached_log"in e&&g(e.attached_log)&&(n.attached_log=e.attached_log),n}}(n);t&&e.report({ev_type:j,payload:t,extra:{timestamp:O()}})})),e.provide("sendLog",(function(n){var t=function(e){if(e&&s(e)&&e.content&&g(e.content)){var n={content:_(e.content),type:"log",level:"info"};if("level"in e&&(n.level=e.level),"extra"in e&&s(e.extra)){var t=e.extra,r={},i={};for(var o in t)p(t[o])?r[o]=t[o]:i[o]=_(t[o]);n.metrics=r,n.categories=i}return"attached_log"in e&&g(e.attached_log)&&(n.attached_log=e.attached_log),n}}(n);t&&e.report({ev_type:j,payload:t,extra:{timestamp:O()}})}))},B=function(e,n){var t=e.common||{};return t.sample_rate=n,e.common=t,e},L=function(e,n,t,r,i){return e?(o=i(r,n),function(){return o}):function(){return t(n)};var o},z=function(e,n,t,r){var i=function(e,n,t){for(var r,i=a(n.split(".")),o=i[0],u=i.slice(1);e&&u.length>0;)e=e[o],o=(r=a(u))[0],u=r.slice(1);if(e)return t(e,o)}(e,n,(function(e,n){return e[n]}));return void 0!==i&&function(e,n,t){switch(t){case"eq":return m(n,e);case"neq":return!m(n,e);case"gt":return e>n[0];case"gte":return e>=n[0];case"lt":return e<n[0];case"lte":return e<=n[0];case"regex":return Boolean(e.match(new RegExp(n.join("|"))));case"not_regex":return!e.match(new RegExp(n.join("|")));default:return!1}}(i,function(e,n){return e.map((function(e){switch(n){case"number":return Number(e);case"boolean":return"1"===e;default:return String(e)}}))}(r,"boolean"==typeof i?"bool":p(i)?"number":"string"),t)},M=function(e,n){try{return"rule"===n.type?z(e,n.field,n.op,n.values):"and"===n.type?n.children.every((function(n){return M(e,n)})):n.children.some((function(n){return M(e,n)}))}catch(e){return T(e),!1}},k=function(e,n,t,r,i){if(!n)return l;var o=n.sample_rate,a=n.include_users,u=n.sample_granularity,c=n.rules,f=n.r,s=void 0===f?Math.random():f;if(m(a,e))return function(e){return B(e,1)};var d="session"===u,v=L(d,o,t,s,r),p=function(e,n,t,r,i,o){var a={};return Object.keys(e).forEach((function(u){var c=e[u],f=c.enable,l=c.sample_rate,s=c.conditional_sample_rules;f?(a[u]={enable:f,sample_rate:l,effectiveSampleRate:l*t,hit:L(n,l,r,i,o)},s&&(a[u].conditional_hit_rules=s.map((function(e){var a=e.sample_rate,u=e.filter;return{sample_rate:a,hit:L(n,a,r,i,o),effectiveSampleRate:a*t,filter:u}})))):a[u]={enable:f,hit:function(){return!1},sample_rate:0,effectiveSampleRate:0}})),a}(c,d,o,t,s,r);return function(e){var n;if(!v())return d&&i[0](),!1;if(!(e.ev_type in p))return B(e,o);if(!p[e.ev_type].enable)return d&&i[1](e.ev_type),!1;if(null===(n=e.common)||void 0===n?void 0:n.sample_rate)return e;var t=p[e.ev_type],r=t.conditional_hit_rules;if(r)for(var a=0;a<r.length;a++)if(M(e,r[a].filter))return!!r[a].hit()&&B(e,r[a].effectiveSampleRate);return t.hit()?B(e,t.effectiveSampleRate):((!r||!r.length)&&d&&i[1](e.ev_type),!1)}},P={build:function(e){return{ev_type:e.ev_type,payload:e.payload,common:o(o({},e.extra||{}),e.overrides||{})}}},G={sample_rate:1,include_users:[],sample_granularity:"session",rules:{}};function q(e){var n,t;try{for(var r=function(e){var n="function"==typeof Symbol&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(["userId","deviceId","sessionId","env"]),i=r.next();!i.done;i=r.next()){var o=i.value;e[o]||delete e[o]}}catch(e){n={error:e}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(n)throw n.error}}return e}function U(e){return q(o({},e))}function F(e){return s(e)&&"bid"in e&&"transport"in e}function Y(e){return q(o({},e))}var K=function(e,n){return void 0===n&&(n="/monitor_web/settings/browser-settings"),(e&&e.indexOf("//")>=0?"":"https://")+e+n},H=function(e){var n,t,r=e,i={},a=f,u=f;return{getConfig:function(){return r},setConfig:function(e){return i=o(o({},i),e||{}),c(),n||(n=e,r.useLocalConfig||!r.bid?(t={},a()):function(e,n,t,r){if(!e.get)return r({});e.get({withCredentials:!0,url:K(n)+"?bid="+t+"&store=1",success:function(e){r(e.data||{})},fail:function(){r({sample:{sample_rate:.001}})}})}(r.transport,r.domain,r.bid,(function(e){t=function(e){if(!e)return{};var n=e.sample,t=e.timestamp,r=e.quota_rate,i=void 0===r?1:r;if(!n)return{};var o=n.sample_rate,a=n.sample_granularity,u=void 0===a?"session":a,c=n.include_users,f=n.rules;return{sample:{include_users:c,sample_rate:o*i,sample_granularity:u,rules:(void 0===f?[]:f).reduce((function(e,n){var t=n.name,r=n.enable,i=n.sample_rate,o=n.conditional_sample_rules;return e[t]={enable:r,sample_rate:i,conditional_sample_rules:o},e}),{})},serverTimestamp:t}}(e),c(),a()}))),r},onChange:function(e){u=e},onReady:function(e){a=e,t&&a()}};function c(){var n=o(o(o({},e),t||{}),i);n.sample=J(J(e.sample,null==t?void 0:t.sample),i.sample),r=n,u()}};function J(e,n){if(!e||!n)return e||n;var t=o(o({},e),n);return t.include_users=u(u([],a(e.include_users||[]),!1),a(n.include_users||[]),!1),t.rules=u(u([],a(Object.keys(e.rules||{})),!1),a(Object.keys(n.rules||{})),!1).reduce((function(t,r){var i,c;return r in t||(r in(e.rules||{})&&r in(n.rules||{})?(t[r]=o(o({},e.rules[r]),n.rules[r]),t[r].conditional_sample_rules=u(u([],a(e.rules[r].conditional_sample_rules||[]),!1),a(n.rules[r].conditional_sample_rules||[]),!1)):t[r]=(null===(i=e.rules)||void 0===i?void 0:i[r])||(null===(c=n.rules)||void 0===c?void 0:c[r])),t}),{}),t}var W=function(e){e.on("report",(function(n){return function(e,n){var t=n||{},r=t.version,i=t.name,a={url:"",protocol:"",domain:"",path:"",query:"",timestamp:Date.now(),sdk_version:r||"2.0.1",sdk_name:i||"SDK_BASE"};return o(o({},e),{extra:o(o({},a),e.extra||{})})}(n,e.config())}))},V=function(e){e.on("beforeBuild",(function(n){return function(e,n){var t={};return t.bid=n.bid,t.pid=n.pid,t.view_id=n.viewId,t.user_id=n.userId,t.device_id=n.deviceId,t.session_id=n.sessionId,t.release=n.release,t.env=n.env,o(o({},e),{extra:o(o({},t),e.extra||{})})}(n,e.config())}))};var Q=function(e){return{bid:"",pid:"",viewId:(n="_",n+"_"+Date.now()),userId:D(),deviceId:D(),sessionId:D(),domain:"mon.zijieapi.com",release:"",env:"production",sample:G,plugins:{},transport:{get:f,post:f},useLocalConfig:!1};var n},Z=function(e){var n=void 0===e?{}:e,t=n.createSender,r=void 0===t?function(e){return function(e){return i(e)}({size:20,endpoint:(n=e.domain,void 0===t&&(t="/monitor_browser/collect/batch/"),(n&&n.indexOf("//")>=0?"":"https://")+n+t),transport:e.transport});var n,t}:t,o=n.builder,a=void 0===o?P:o,u=n.createDefaultConfig,c=x({validateInitConfig:F,initConfigNormalizer:U,userConfigNormalizer:Y,createSender:r,builder:a,createDefaultConfig:void 0===u?Q:u,createConfigManager:H});return A(c),V(c),W(c),function(e){e.on("init",(function(){var n=[],t=function(t){t.forEach((function(t){var r=t.name;m(n,r)||(n.push(r),t.setup(e),e.destroyAgent.set(r,r,[function(){n=h(n,r),t.tearDown&&t.tearDown()}]))}))};e.provide("applyIntegrations",t);var r=e.config();r&&r.integrations&&t(r.integrations)}))}(c),c},X=function(e){void 0===e&&(e={});var n=Z(e);return function(e){e.on("start",(function(){var n=e.config(),t=n.userId,r=n.sample,i=k(t,r,E,I,[function(){e.destroy()},function(n){e.destroyAgent.removeByEvType(n)}]);e.on("build",i)}))}(n),N(n),n};X();var $,ee={};var ne,te=($||($=1,function(e){function n(e){var n,t=e.transport,r=e.endpoint,i=e.size,o=void 0===i?10:i,a=e.wait,u=void 0===a?1e3:a,c=[],f=0;function l(){if(c.length){var e=this.getBatchData();t.post({url:r,data:e,fail:function(t){n&&n(t,e)}}),c=[]}}return{getSize:function(){return o},getWait:function(){return u},setSize:function(e){o=e},setWait:function(e){u=e},getEndpoint:function(){return r},setEndpoint:function(e){r=e},send:function(e){c.push(e),c.length>=o&&l.call(this),clearTimeout(f),f=setTimeout(l.bind(this),u)},flush:function(){clearTimeout(f),l.call(this)},getBatchData:function(){return c.length?(e=c,JSON.stringify({ev_type:"batch",list:e})):"";var e},clear:function(){clearTimeout(f),c=[]},fail:function(e){n=e}}}
/*! *****************************************************************************
		Copyright (c) Microsoft Corporation.

		Permission to use, copy, modify, and/or distribute this software for any
		purpose with or without fee is hereby granted.

		THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
		REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
		AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
		INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
		LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
		OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
		PERFORMANCE OF THIS SOFTWARE.
		***************************************************************************** */Object.defineProperty(e,"__esModule",{value:!0});var t=function(){return t=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},t.apply(this,arguments)};function r(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var r,i,o=t.call(e),a=[];try{for(;(void 0===n||n-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(t=o.return)&&t.call(o)}finally{if(i)throw i.error}}return a}function i(e,n,t){if(2===arguments.length)for(var r,i=0,o=n.length;i<o;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return e.concat(r||Array.prototype.slice.call(n))}var o=["init","start","config","beforeDestroy","provide","beforeReport","report","beforeBuild","build","beforeSend","send","beforeConfig"],a=function(){return{}};function u(e){return e}function c(e){return"object"==typeof e&&null!==e}var f=Object.prototype;function l(e){return"[object Array]"===f.toString.call(e)}function s(e){return"number"==typeof e}function d(e){return"string"==typeof e}function v(e,n){if(!l(e))return!1;if(0===e.length)return!1;for(var t=0;t<e.length;){if(e[t]===n)return!0;t++}return!1}var p=function(e,n){if(!l(e))return e;var t=e.indexOf(n);if(t>=0){var r=e.slice();return r.splice(t,1),r}return e};function g(e){try{return d(e)?e:JSON.stringify(e)}catch(e){return"[FAILED_TO_STRINGIFY]:"+String(e)}}var m="".padStart?function(e,n){return void 0===n&&(n=8),e.padStart(n," ")}:function(e){return e},h=0,_=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];console.error.apply(console,i(["[SDK]",Date.now(),m(""+h++)],r(e),!1))},y=0,b=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];console.warn.apply(console,i(["[SDK]",Date.now(),m(""+y++)],r(e),!1))},S=function(e){return Math.random()<Number(e)},C=function(e,n){return e<Number(n)},w=function(e){return function(n){for(var t=n,r=0;r<e.length&&t;r++)try{t=e[r](t)}catch(e){_(e)}return t}};function E(){var e=function(){for(var e=new Array(16),n=0,t=0;t<16;t++)3&t||(n=4294967296*Math.random()),e[t]=n>>>((3&t)<<3)&255;return e}();return e[6]=15&e[6]|64,e[8]=63&e[8]|128,function(e){for(var n=[],t=0;t<256;++t)n[t]=(t+256).toString(16).substr(1);var r=0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}(e)}function I(e){var n,t,a=e.builder,u=e.createSender,f=e.createDefaultConfig,l=e.createConfigManager,s=e.userConfigNormalizer,d=e.initConfigNormalizer,g=e.validateInitConfig,m={};o.forEach((function(e){return m[e]=[]}));var h=!1,_=!1,y=!1,S=[],C=[],E=function(){var e=!1,n={},t=function(e){e.length&&e.forEach((function(e){try{e()}catch(e){}})),e.length=0},r=function(e){n[e]&&n[e].forEach((function(e){t(e[1])})),n[e]=void 0};return{set:function(r,i,o){n[r]?n[r].push([i,o]):n[r]=[[i,o]],e&&t(o)},has:function(e){return!!n[e]},remove:r,removeByEvType:function(e){Object.keys(n).forEach((function(r){n[r]&&n[r].forEach((function(n){n[0]===e&&t(n[1])}))}))},clear:function(){e=!0,Object.keys(n).forEach((function(e){r(e)}))}}}(),I={getBuilder:function(){return a},getSender:function(){return n},getPreStartQueue:function(){return S},init:function(e){if(h)b("already inited");else{if(!(e&&c(e)&&g(e)))throw new Error("invalid InitConfig, init failed");var r=f(e);if(!r)throw new Error("defaultConfig missing");var i=d(e);if((t=l(r)).setConfig(i),t.onChange((function(){R("config")})),!(n=u(t.getConfig())))throw new Error("sender missing");h=!0,R("init",!0)}},set:function(e){h&&e&&c(e)&&(R("beforeConfig",!1,e),null==t||t.setConfig(e))},config:function(e){if(h)return e&&c(e)&&(R("beforeConfig",!1,e),null==t||t.setConfig(s(e))),null==t?void 0:t.getConfig()},provide:function(e,n){v(C,e)?b("cannot provide "+e+", reserved"):(I[e]=n,R("provide",!1,e))},start:function(){var e=this;h&&(_||null==t||t.onReady((function(){_=!0,R("start",!0),S.forEach((function(n){return e.build(n)})),S.length=0})))},report:function(e){if(e){var n=w(m.beforeReport)(e);if(n){var t=w(m.report)(n);t&&(_?this.build(t):S.push(t))}}},build:function(e){if(_){var n=w(m.beforeBuild)(e);if(n){var t=a.build(n);if(t){var r=w(m.build)(t);r&&this.send(r)}}}},send:function(e){if(_){var t=w(m.beforeSend)(e);t&&(n.send(t),R("send",!1,t))}},destroy:function(){E.clear(),y=!0,S.length=0,R("beforeDestroy",!0)},on:function(e,n){if("init"===e&&h||"start"===e&&_||"beforeDestroy"===e&&y)try{n()}catch(e){}else m[e]&&m[e].push(n)},off:function(e,n){m[e]&&(m[e]=p(m[e],n))},destroyAgent:E};return C=Object.keys(I),I;function R(e,n){void 0===n&&(n=!1);for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];m[e].forEach((function(e){try{e.apply(void 0,i([],r(t),!1))}catch(e){}})),n&&(m[e].length=0)}}var R=function(e){var n=function(){var e={},n={},r={set:function(t,i){return e[t]=i,n[t]=g(i),r},merge:function(i){return e=t(t({},e),i),Object.keys(i).forEach((function(e){n[e]=g(i[e])})),r},delete:function(t){return delete e[t],delete n[t],r},clear:function(){return e={},n={},r},get:function(e){return n[e]},toString:function(){return t({},n)}};return r}();e.provide("context",n),e.on("report",(function(e){return e.extra||(e.extra={}),e.extra.context=n.toString(),e}))},D=function(){return Date.now()},x=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var t=function(e){if(e)return e.__SLARDAR_REGISTRY__||(e.__SLARDAR_REGISTRY__={Slardar:{plugins:[],errors:[],subject:{}}}),e.__SLARDAR_REGISTRY__.Slardar}(function(){if("object"==typeof window&&c(window))return window}());t&&(t.errors||(t.errors=[]),t.errors.push(e))},A="custom",O=function(e){e.provide("sendEvent",(function(n){var t=function(e){if(e&&c(e)&&e.name&&d(e.name)){var n={name:e.name,type:"event"};if("metrics"in e&&c(e.metrics)){var t=e.metrics,r={};for(var i in t)s(t[i])&&(r[i]=t[i]);n.metrics=r}if("categories"in e&&c(e.categories)){var o=e.categories,a={};for(var i in o)a[i]=g(o[i]);n.categories=a}return"attached_log"in e&&d(e.attached_log)&&(n.attached_log=e.attached_log),n}}(n);t&&e.report({ev_type:A,payload:t,extra:{timestamp:D()}})})),e.provide("sendLog",(function(n){var t=function(e){if(e&&c(e)&&e.content&&d(e.content)){var n={content:g(e.content),type:"log",level:"info"};if("level"in e&&(n.level=e.level),"extra"in e&&c(e.extra)){var t=e.extra,r={},i={};for(var o in t)s(t[o])?r[o]=t[o]:i[o]=g(t[o]);n.metrics=r,n.categories=i}return"attached_log"in e&&d(e.attached_log)&&(n.attached_log=e.attached_log),n}}(n);t&&e.report({ev_type:A,payload:t,extra:{timestamp:D()}})}))},T=function(e,n){var t=e.common||{};return t.sample_rate=n,e.common=t,e},j=function(e,n,t,r,i){return e?(o=i(r,n),function(){return o}):function(){return t(n)};var o},N=function(e,n,t,i){var o=function(e,n,t){for(var i,o=r(n.split(".")),a=o[0],u=o.slice(1);e&&u.length>0;)e=e[a],a=(i=r(u))[0],u=i.slice(1);if(e)return t(e,a)}(e,n,(function(e,n){return e[n]}));return void 0!==o&&function(e,n,t){switch(t){case"eq":return v(n,e);case"neq":return!v(n,e);case"gt":return e>n[0];case"gte":return e>=n[0];case"lt":return e<n[0];case"lte":return e<=n[0];case"regex":return Boolean(e.match(new RegExp(n.join("|"))));case"not_regex":return!e.match(new RegExp(n.join("|")));default:return!1}}(o,function(e,n){return e.map((function(e){switch(n){case"number":return Number(e);case"boolean":return"1"===e;default:return String(e)}}))}(i,"boolean"==typeof o?"bool":s(o)?"number":"string"),t)},B=function(e,n){try{return"rule"===n.type?N(e,n.field,n.op,n.values):"and"===n.type?n.children.every((function(n){return B(e,n)})):n.children.some((function(n){return B(e,n)}))}catch(e){return x(e),!1}},L=function(e,n,t,r,i){if(!n)return u;var o=n.sample_rate,a=n.include_users,c=n.sample_granularity,f=n.rules,l=n.r,s=void 0===l?Math.random():l;if(v(a,e))return function(e){return T(e,1)};var d="session"===c,p=j(d,o,t,s,r),g=function(e,n,t,r,i,o){var a={};return Object.keys(e).forEach((function(u){var c=e[u],f=c.enable,l=c.sample_rate,s=c.conditional_sample_rules;f?(a[u]={enable:f,sample_rate:l,effectiveSampleRate:l*t,hit:j(n,l,r,i,o)},s&&(a[u].conditional_hit_rules=s.map((function(e){var a=e.sample_rate,u=e.filter;return{sample_rate:a,hit:j(n,a,r,i,o),effectiveSampleRate:a*t,filter:u}})))):a[u]={enable:f,hit:function(){return!1},sample_rate:0,effectiveSampleRate:0}})),a}(f,d,o,t,s,r);return function(e){var n;if(!p())return d&&i[0](),!1;if(!(e.ev_type in g))return T(e,o);if(!g[e.ev_type].enable)return d&&i[1](e.ev_type),!1;if(null===(n=e.common)||void 0===n?void 0:n.sample_rate)return e;var t=g[e.ev_type],r=t.conditional_hit_rules;if(r)for(var a=0;a<r.length;a++)if(B(e,r[a].filter))return!!r[a].hit()&&T(e,r[a].effectiveSampleRate);return t.hit()?T(e,t.effectiveSampleRate):((!r||!r.length)&&d&&i[1](e.ev_type),!1)}},z={build:function(e){return{ev_type:e.ev_type,payload:e.payload,common:t(t({},e.extra||{}),e.overrides||{})}}},M="mon-va.byteoversea.com",k=M,P="2.0.1",G="SDK_BASE",q="/monitor_web/settings/browser-settings",U="/monitor_browser/collect/batch/",F={sample_rate:1,include_users:[],sample_granularity:"session",rules:{}},Y="session";function K(e){var n,t;try{for(var r=function(e){var n="function"==typeof Symbol&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(["userId","deviceId","sessionId","env"]),i=r.next();!i.done;i=r.next()){var o=i.value;e[o]||delete e[o]}}catch(e){n={error:e}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(n)throw n.error}}return e}function H(e){return K(t({},e))}function J(e){return c(e)&&"bid"in e&&"transport"in e}function W(e){return K(t({},e))}function V(e){if(!e)return{};var n=e.sample,t=e.timestamp,r=e.quota_rate,i=void 0===r?1:r;if(!n)return{};var o=n.sample_rate,a=n.sample_granularity,u=void 0===a?Y:a,c=n.include_users,f=n.rules;return{sample:{include_users:c,sample_rate:o*i,sample_granularity:u,rules:(void 0===f?[]:f).reduce((function(e,n){var t=n.name,r=n.enable,i=n.sample_rate,o=n.conditional_sample_rules;return e[t]={enable:r,sample_rate:i,conditional_sample_rules:o},e}),{})},serverTimestamp:t}}var Q=function(e,n){return void 0===n&&(n=U),(e&&e.indexOf("//")>=0?"":"https://")+e+n},Z=function(e,n){return void 0===n&&(n=q),(e&&e.indexOf("//")>=0?"":"https://")+e+n},X=function(){return E()},$=function(){return E()},ee=function(e){return e+"_"+Date.now()},ne=function(){return E()},te=function(e){var n,r,i=e,o={},u=a,c=a;return{getConfig:function(){return i},setConfig:function(e){return o=t(t({},o),e||{}),f(),n||(n=e,i.useLocalConfig||!i.bid?(r={},u()):re(i.transport,i.domain,i.bid,(function(e){r=V(e),f(),u()}))),i},onChange:function(e){c=e},onReady:function(e){u=e,r&&u()}};function f(){var n=t(t(t({},e),r||{}),o);n.sample=ie(ie(e.sample,null==r?void 0:r.sample),o.sample),i=n,c()}};function re(e,n,t,r){if(!e.get)return r({});e.get({withCredentials:!0,url:Z(n)+"?bid="+t+"&store=1",success:function(e){r(e.data||{})},fail:function(){r({sample:{sample_rate:.001}})}})}function ie(e,n){if(!e||!n)return e||n;var o=t(t({},e),n);return o.include_users=i(i([],r(e.include_users||[]),!1),r(n.include_users||[]),!1),o.rules=i(i([],r(Object.keys(e.rules||{})),!1),r(Object.keys(n.rules||{})),!1).reduce((function(o,a){var u,c;return a in o||(a in(e.rules||{})&&a in(n.rules||{})?(o[a]=t(t({},e.rules[a]),n.rules[a]),o[a].conditional_sample_rules=i(i([],r(e.rules[a].conditional_sample_rules||[]),!1),r(n.rules[a].conditional_sample_rules||[]),!1)):o[a]=(null===(u=e.rules)||void 0===u?void 0:u[a])||(null===(c=n.rules)||void 0===c?void 0:c[a])),o}),{}),o}var oe=function(e,n){var r=n||{},i=r.version,o=r.name,a={url:"",protocol:"",domain:"",path:"",query:"",timestamp:Date.now(),sdk_version:i||P,sdk_name:o||G};return t(t({},e),{extra:t(t({},a),e.extra||{})})},ae=function(e){e.on("report",(function(n){return oe(n,e.config())}))},ue=function(e,n){var r={};return r.bid=n.bid,r.pid=n.pid,r.view_id=n.viewId,r.user_id=n.userId,r.device_id=n.deviceId,r.session_id=n.sessionId,r.release=n.release,r.env=n.env,t(t({},e),{extra:t(t({},r),e.extra||{})})},ce=function(e){e.on("beforeBuild",(function(n){return ue(n,e.config())}))},fe=function(e){return{bid:"",pid:"",viewId:ee("_"),userId:X(),deviceId:$(),sessionId:ne(),domain:M,release:"",env:"production",sample:F,plugins:{},transport:{get:a,post:a},useLocalConfig:!1}},le=function(e){var t=void 0===e?{}:e,r=t.createSender,i=void 0===r?function(e){return function(e){return n(e)}({size:20,endpoint:Q(e.domain),transport:e.transport})}:r,o=t.builder,a=void 0===o?z:o,u=t.createDefaultConfig,c=I({validateInitConfig:J,initConfigNormalizer:H,userConfigNormalizer:W,createSender:i,builder:a,createDefaultConfig:void 0===u?fe:u,createConfigManager:te});return R(c),ce(c),ae(c),function(e){e.on("init",(function(){var n=[],t=function(t){t.forEach((function(t){var r=t.name;v(n,r)||(n.push(r),t.setup(e),e.destroyAgent.set(r,r,[function(){n=p(n,r),t.tearDown&&t.tearDown()}]))}))};e.provide("applyIntegrations",t);var r=e.config();r&&r.integrations&&t(r.integrations)}))}(c),c},se=function(e){void 0===e&&(e={});var n=le(e);return function(e){e.on("start",(function(){var n=e.config(),t=n.userId,r=n.sample,i=L(t,r,S,C,[function(){e.destroy()},function(n){e.destroyAgent.removeByEvType(n)}]);e.on("build",i)}))}(n),O(n),n},de=se();e.BATCH_REPORT_PATH=U,e.CustomPlugin=O,e.DEFAULT_SAMPLE_CONFIG=F,e.DEFAULT_SAMPLE_GRANULARITY=Y,e.DEFAULT_SENDER_SIZE=20,e.InjectConfigPlugin=ce,e.InjectEnvPlugin=ae,e.REPORT_DOMAIN=M,e.SDK_NAME=G,e.SDK_VERSION=P,e.SETTINGS_DOMAIN=k,e.SETTINGS_PATH=q,e.addConfigToReportEvent=ue,e.addEnvToSendEvent=oe,e.builder=z,e.createBaseClient=se,e.createConfigManager=te,e.createMinimalClient=le,e.default=de,e.getDefaultConfig=fe,e.getDefaultDeviceId=$,e.getDefaultSessionId=ne,e.getDefaultUserId=X,e.getReportUrl=Q,e.getServerConfig=re,e.getSettingsUrl=Z,e.getViewId=ee,e.mergeSampleConfig=ie,e.normalizeInitConfig=H,e.normalizeStrictFields=K,e.normalizeUserConfig=W,e.parseServerConfig=V,e.validateInitConfig=J}(ee)),ee),re={};var ie=(ne||(ne=1,function(e){function n(e){var n,t=e.transport,r=e.endpoint,i=e.size,o=void 0===i?10:i,a=e.wait,u=void 0===a?1e3:a,c=[],f=0;function l(){if(c.length){var e=this.getBatchData();t.post({url:r,data:e,fail:function(t){n&&n(t,e)}}),c=[]}}return{getSize:function(){return o},getWait:function(){return u},setSize:function(e){o=e},setWait:function(e){u=e},getEndpoint:function(){return r},setEndpoint:function(e){r=e},send:function(e){c.push(e),c.length>=o&&l.call(this),clearTimeout(f),f=setTimeout(l.bind(this),u)},flush:function(){clearTimeout(f),l.call(this)},getBatchData:function(){return c.length?(e=c,JSON.stringify({ev_type:"batch",list:e})):"";var e},clear:function(){clearTimeout(f),c=[]},fail:function(e){n=e}}}
/*! *****************************************************************************
		Copyright (c) Microsoft Corporation.

		Permission to use, copy, modify, and/or distribute this software for any
		purpose with or without fee is hereby granted.

		THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
		REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
		AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
		INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
		LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
		OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
		PERFORMANCE OF THIS SOFTWARE.
		***************************************************************************** */Object.defineProperty(e,"__esModule",{value:!0});var t=function(){return t=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},t.apply(this,arguments)};function r(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var r,i,o=t.call(e),a=[];try{for(;(void 0===n||n-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(t=o.return)&&t.call(o)}finally{if(i)throw i.error}}return a}function i(e,n,t){if(2===arguments.length)for(var r,i=0,o=n.length;i<o;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return e.concat(r||Array.prototype.slice.call(n))}var o=["init","start","config","beforeDestroy","provide","beforeReport","report","beforeBuild","build","beforeSend","send","beforeConfig"],a=function(){return{}};function u(e){return e}function c(e){return"object"==typeof e&&null!==e}var f=Object.prototype;function l(e){return"[object Array]"===f.toString.call(e)}function s(e){return"number"==typeof e}function d(e){return"string"==typeof e}function v(e,n){if(!l(e))return!1;if(0===e.length)return!1;for(var t=0;t<e.length;){if(e[t]===n)return!0;t++}return!1}var p=function(e,n){if(!l(e))return e;var t=e.indexOf(n);if(t>=0){var r=e.slice();return r.splice(t,1),r}return e};function g(e){try{return d(e)?e:JSON.stringify(e)}catch(e){return"[FAILED_TO_STRINGIFY]:"+String(e)}}var m="".padStart?function(e,n){return void 0===n&&(n=8),e.padStart(n," ")}:function(e){return e},h=0,_=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];console.error.apply(console,i(["[SDK]",Date.now(),m(""+h++)],r(e),!1))},y=0,b=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];console.warn.apply(console,i(["[SDK]",Date.now(),m(""+y++)],r(e),!1))},S=function(e){return Math.random()<Number(e)},C=function(e,n){return e<Number(n)},w=function(e){return function(n){for(var t=n,r=0;r<e.length&&t;r++)try{t=e[r](t)}catch(e){_(e)}return t}};function E(){var e=function(){for(var e=new Array(16),n=0,t=0;t<16;t++)3&t||(n=4294967296*Math.random()),e[t]=n>>>((3&t)<<3)&255;return e}();return e[6]=15&e[6]|64,e[8]=63&e[8]|128,function(e){for(var n=[],t=0;t<256;++t)n[t]=(t+256).toString(16).substr(1);var r=0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}(e)}function I(e){var n,t,a=e.builder,u=e.createSender,f=e.createDefaultConfig,l=e.createConfigManager,s=e.userConfigNormalizer,d=e.initConfigNormalizer,g=e.validateInitConfig,m={};o.forEach((function(e){return m[e]=[]}));var h=!1,_=!1,y=!1,S=[],C=[],E=function(){var e=!1,n={},t=function(e){e.length&&e.forEach((function(e){try{e()}catch(e){}})),e.length=0},r=function(e){n[e]&&n[e].forEach((function(e){t(e[1])})),n[e]=void 0};return{set:function(r,i,o){n[r]?n[r].push([i,o]):n[r]=[[i,o]],e&&t(o)},has:function(e){return!!n[e]},remove:r,removeByEvType:function(e){Object.keys(n).forEach((function(r){n[r]&&n[r].forEach((function(n){n[0]===e&&t(n[1])}))}))},clear:function(){e=!0,Object.keys(n).forEach((function(e){r(e)}))}}}(),I={getBuilder:function(){return a},getSender:function(){return n},getPreStartQueue:function(){return S},init:function(e){if(h)b("already inited");else{if(!(e&&c(e)&&g(e)))throw new Error("invalid InitConfig, init failed");var r=f(e);if(!r)throw new Error("defaultConfig missing");var i=d(e);if((t=l(r)).setConfig(i),t.onChange((function(){R("config")})),!(n=u(t.getConfig())))throw new Error("sender missing");h=!0,R("init",!0)}},set:function(e){h&&e&&c(e)&&(R("beforeConfig",!1,e),null==t||t.setConfig(e))},config:function(e){if(h)return e&&c(e)&&(R("beforeConfig",!1,e),null==t||t.setConfig(s(e))),null==t?void 0:t.getConfig()},provide:function(e,n){v(C,e)?b("cannot provide "+e+", reserved"):(I[e]=n,R("provide",!1,e))},start:function(){var e=this;h&&(_||null==t||t.onReady((function(){_=!0,R("start",!0),S.forEach((function(n){return e.build(n)})),S.length=0})))},report:function(e){if(e){var n=w(m.beforeReport)(e);if(n){var t=w(m.report)(n);t&&(_?this.build(t):S.push(t))}}},build:function(e){if(_){var n=w(m.beforeBuild)(e);if(n){var t=a.build(n);if(t){var r=w(m.build)(t);r&&this.send(r)}}}},send:function(e){if(_){var t=w(m.beforeSend)(e);t&&(n.send(t),R("send",!1,t))}},destroy:function(){E.clear(),y=!0,S.length=0,R("beforeDestroy",!0)},on:function(e,n){if("init"===e&&h||"start"===e&&_||"beforeDestroy"===e&&y)try{n()}catch(e){}else m[e]&&m[e].push(n)},off:function(e,n){m[e]&&(m[e]=p(m[e],n))},destroyAgent:E};return C=Object.keys(I),I;function R(e,n){void 0===n&&(n=!1);for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];m[e].forEach((function(e){try{e.apply(void 0,i([],r(t),!1))}catch(e){}})),n&&(m[e].length=0)}}var R=function(e){var n=function(){var e={},n={},r={set:function(t,i){return e[t]=i,n[t]=g(i),r},merge:function(i){return e=t(t({},e),i),Object.keys(i).forEach((function(e){n[e]=g(i[e])})),r},delete:function(t){return delete e[t],delete n[t],r},clear:function(){return e={},n={},r},get:function(e){return n[e]},toString:function(){return t({},n)}};return r}();e.provide("context",n),e.on("report",(function(e){return e.extra||(e.extra={}),e.extra.context=n.toString(),e}))},D=function(){return Date.now()},x=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var t=function(e){if(e)return e.__SLARDAR_REGISTRY__||(e.__SLARDAR_REGISTRY__={Slardar:{plugins:[],errors:[],subject:{}}}),e.__SLARDAR_REGISTRY__.Slardar}(function(){if("object"==typeof window&&c(window))return window}());t&&(t.errors||(t.errors=[]),t.errors.push(e))},A="custom",O=function(e){e.provide("sendEvent",(function(n){var t=function(e){if(e&&c(e)&&e.name&&d(e.name)){var n={name:e.name,type:"event"};if("metrics"in e&&c(e.metrics)){var t=e.metrics,r={};for(var i in t)s(t[i])&&(r[i]=t[i]);n.metrics=r}if("categories"in e&&c(e.categories)){var o=e.categories,a={};for(var i in o)a[i]=g(o[i]);n.categories=a}return"attached_log"in e&&d(e.attached_log)&&(n.attached_log=e.attached_log),n}}(n);t&&e.report({ev_type:A,payload:t,extra:{timestamp:D()}})})),e.provide("sendLog",(function(n){var t=function(e){if(e&&c(e)&&e.content&&d(e.content)){var n={content:g(e.content),type:"log",level:"info"};if("level"in e&&(n.level=e.level),"extra"in e&&c(e.extra)){var t=e.extra,r={},i={};for(var o in t)s(t[o])?r[o]=t[o]:i[o]=g(t[o]);n.metrics=r,n.categories=i}return"attached_log"in e&&d(e.attached_log)&&(n.attached_log=e.attached_log),n}}(n);t&&e.report({ev_type:A,payload:t,extra:{timestamp:D()}})}))},T=function(e,n){var t=e.common||{};return t.sample_rate=n,e.common=t,e},j=function(e,n,t,r,i){return e?(o=i(r,n),function(){return o}):function(){return t(n)};var o},N=function(e,n,t,i){var o=function(e,n,t){for(var i,o=r(n.split(".")),a=o[0],u=o.slice(1);e&&u.length>0;)e=e[a],a=(i=r(u))[0],u=i.slice(1);if(e)return t(e,a)}(e,n,(function(e,n){return e[n]}));return void 0!==o&&function(e,n,t){switch(t){case"eq":return v(n,e);case"neq":return!v(n,e);case"gt":return e>n[0];case"gte":return e>=n[0];case"lt":return e<n[0];case"lte":return e<=n[0];case"regex":return Boolean(e.match(new RegExp(n.join("|"))));case"not_regex":return!e.match(new RegExp(n.join("|")));default:return!1}}(o,function(e,n){return e.map((function(e){switch(n){case"number":return Number(e);case"boolean":return"1"===e;default:return String(e)}}))}(i,"boolean"==typeof o?"bool":s(o)?"number":"string"),t)},B=function(e,n){try{return"rule"===n.type?N(e,n.field,n.op,n.values):"and"===n.type?n.children.every((function(n){return B(e,n)})):n.children.some((function(n){return B(e,n)}))}catch(e){return x(e),!1}},L=function(e,n,t,r,i){if(!n)return u;var o=n.sample_rate,a=n.include_users,c=n.sample_granularity,f=n.rules,l=n.r,s=void 0===l?Math.random():l;if(v(a,e))return function(e){return T(e,1)};var d="session"===c,p=j(d,o,t,s,r),g=function(e,n,t,r,i,o){var a={};return Object.keys(e).forEach((function(u){var c=e[u],f=c.enable,l=c.sample_rate,s=c.conditional_sample_rules;f?(a[u]={enable:f,sample_rate:l,effectiveSampleRate:l*t,hit:j(n,l,r,i,o)},s&&(a[u].conditional_hit_rules=s.map((function(e){var a=e.sample_rate,u=e.filter;return{sample_rate:a,hit:j(n,a,r,i,o),effectiveSampleRate:a*t,filter:u}})))):a[u]={enable:f,hit:function(){return!1},sample_rate:0,effectiveSampleRate:0}})),a}(f,d,o,t,s,r);return function(e){var n;if(!p())return d&&i[0](),!1;if(!(e.ev_type in g))return T(e,o);if(!g[e.ev_type].enable)return d&&i[1](e.ev_type),!1;if(null===(n=e.common)||void 0===n?void 0:n.sample_rate)return e;var t=g[e.ev_type],r=t.conditional_hit_rules;if(r)for(var a=0;a<r.length;a++)if(B(e,r[a].filter))return!!r[a].hit()&&T(e,r[a].effectiveSampleRate);return t.hit()?T(e,t.effectiveSampleRate):((!r||!r.length)&&d&&i[1](e.ev_type),!1)}},z={build:function(e){return{ev_type:e.ev_type,payload:e.payload,common:t(t({},e.extra||{}),e.overrides||{})}}},M="mon-va.byteoversea.com",k=M,P="2.0.1",G="SDK_BASE",q="/monitor_web/settings/browser-settings",U="/monitor_browser/collect/batch/",F={sample_rate:1,include_users:[],sample_granularity:"session",rules:{}},Y="session";function K(e){var n,t;try{for(var r=function(e){var n="function"==typeof Symbol&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(["userId","deviceId","sessionId","env"]),i=r.next();!i.done;i=r.next()){var o=i.value;e[o]||delete e[o]}}catch(e){n={error:e}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(n)throw n.error}}return e}function H(e){return K(t({},e))}function J(e){return c(e)&&"bid"in e&&"transport"in e}function W(e){return K(t({},e))}function V(e){if(!e)return{};var n=e.sample,t=e.timestamp,r=e.quota_rate,i=void 0===r?1:r;if(!n)return{};var o=n.sample_rate,a=n.sample_granularity,u=void 0===a?Y:a,c=n.include_users,f=n.rules;return{sample:{include_users:c,sample_rate:o*i,sample_granularity:u,rules:(void 0===f?[]:f).reduce((function(e,n){var t=n.name,r=n.enable,i=n.sample_rate,o=n.conditional_sample_rules;return e[t]={enable:r,sample_rate:i,conditional_sample_rules:o},e}),{})},serverTimestamp:t}}var Q=function(e,n){return void 0===n&&(n=U),(e&&e.indexOf("//")>=0?"":"https://")+e+n},Z=function(e,n){return void 0===n&&(n=q),(e&&e.indexOf("//")>=0?"":"https://")+e+n},X=function(){return E()},$=function(){return E()},ee=function(e){return e+"_"+Date.now()},ne=function(){return E()},te=function(e){var n,r,i=e,o={},u=a,c=a;return{getConfig:function(){return i},setConfig:function(e){return o=t(t({},o),e||{}),f(),n||(n=e,i.useLocalConfig||!i.bid?(r={},u()):re(i.transport,i.domain,i.bid,(function(e){r=V(e),f(),u()}))),i},onChange:function(e){c=e},onReady:function(e){u=e,r&&u()}};function f(){var n=t(t(t({},e),r||{}),o);n.sample=ie(ie(e.sample,null==r?void 0:r.sample),o.sample),i=n,c()}};function re(e,n,t,r){if(!e.get)return r({});e.get({withCredentials:!0,url:Z(n)+"?bid="+t+"&store=1",success:function(e){r(e.data||{})},fail:function(){r({sample:{sample_rate:.001}})}})}function ie(e,n){if(!e||!n)return e||n;var o=t(t({},e),n);return o.include_users=i(i([],r(e.include_users||[]),!1),r(n.include_users||[]),!1),o.rules=i(i([],r(Object.keys(e.rules||{})),!1),r(Object.keys(n.rules||{})),!1).reduce((function(o,a){var u,c;return a in o||(a in(e.rules||{})&&a in(n.rules||{})?(o[a]=t(t({},e.rules[a]),n.rules[a]),o[a].conditional_sample_rules=i(i([],r(e.rules[a].conditional_sample_rules||[]),!1),r(n.rules[a].conditional_sample_rules||[]),!1)):o[a]=(null===(u=e.rules)||void 0===u?void 0:u[a])||(null===(c=n.rules)||void 0===c?void 0:c[a])),o}),{}),o}var oe=function(e,n){var r=n||{},i=r.version,o=r.name,a={url:"",protocol:"",domain:"",path:"",query:"",timestamp:Date.now(),sdk_version:i||P,sdk_name:o||G};return t(t({},e),{extra:t(t({},a),e.extra||{})})},ae=function(e){e.on("report",(function(n){return oe(n,e.config())}))},ue=function(e,n){var r={};return r.bid=n.bid,r.pid=n.pid,r.view_id=n.viewId,r.user_id=n.userId,r.device_id=n.deviceId,r.session_id=n.sessionId,r.release=n.release,r.env=n.env,t(t({},e),{extra:t(t({},r),e.extra||{})})},ce=function(e){e.on("beforeBuild",(function(n){return ue(n,e.config())}))},fe=function(e){return{bid:"",pid:"",viewId:ee("_"),userId:X(),deviceId:$(),sessionId:ne(),domain:M,release:"",env:"production",sample:F,plugins:{},transport:{get:a,post:a},useLocalConfig:!1}},le=function(e){var t=void 0===e?{}:e,r=t.createSender,i=void 0===r?function(e){return function(e){return n(e)}({size:20,endpoint:Q(e.domain),transport:e.transport})}:r,o=t.builder,a=void 0===o?z:o,u=t.createDefaultConfig,c=I({validateInitConfig:J,initConfigNormalizer:H,userConfigNormalizer:W,createSender:i,builder:a,createDefaultConfig:void 0===u?fe:u,createConfigManager:te});return R(c),ce(c),ae(c),function(e){e.on("init",(function(){var n=[],t=function(t){t.forEach((function(t){var r=t.name;v(n,r)||(n.push(r),t.setup(e),e.destroyAgent.set(r,r,[function(){n=p(n,r),t.tearDown&&t.tearDown()}]))}))};e.provide("applyIntegrations",t);var r=e.config();r&&r.integrations&&t(r.integrations)}))}(c),c},se=function(e){void 0===e&&(e={});var n=le(e);return function(e){e.on("start",(function(){var n=e.config(),t=n.userId,r=n.sample,i=L(t,r,S,C,[function(){e.destroy()},function(n){e.destroyAgent.removeByEvType(n)}]);e.on("build",i)}))}(n),O(n),n},de=se();e.BATCH_REPORT_PATH=U,e.CustomPlugin=O,e.DEFAULT_SAMPLE_CONFIG=F,e.DEFAULT_SAMPLE_GRANULARITY=Y,e.DEFAULT_SENDER_SIZE=20,e.InjectConfigPlugin=ce,e.InjectEnvPlugin=ae,e.REPORT_DOMAIN=M,e.SDK_NAME=G,e.SDK_VERSION=P,e.SETTINGS_DOMAIN=k,e.SETTINGS_PATH=q,e.addConfigToReportEvent=ue,e.addEnvToSendEvent=oe,e.builder=z,e.createBaseClient=se,e.createConfigManager=te,e.createMinimalClient=le,e.default=de,e.getDefaultConfig=fe,e.getDefaultDeviceId=$,e.getDefaultSessionId=ne,e.getDefaultUserId=X,e.getReportUrl=Q,e.getServerConfig=re,e.getSettingsUrl=Z,e.getViewId=ee,e.mergeSampleConfig=ie,e.normalizeInitConfig=H,e.normalizeStrictFields=K,e.normalizeUserConfig=W,e.parseServerConfig=V,e.validateInitConfig=J}(re)),re);const oe=require("axios");class ae{_requestClient=oe.create({proxy:!1});get(e){this._requestClient.request({method:"get",...e}).then((n=>{e.success&&e.success(n.data)})).catch((n=>{e.fail&&e.fail(n)}))}post(e){this._requestClient.request({method:"post",...e})}}function ue(t,r,i){const o=(()=>{switch(i){case n.Region.CN:return X();case n.Region.US:return te.createBaseClient();case n.Region.SG:return ie.createBaseClient();default:return X()}})();if(r)for(const[e,n]of Object.entries(r))o.context?.set(e,n);const{bid:a}=e({region:i});return o.init({bid:a,transport:new ae,useLocalConfig:!0,...t}),o.start(),o}function ce(e,i,o){const a=n.getEnviromentVariables();return ue({env:t(a),userId:r(a),...e},{...i},o)}export{ce as createDefaultSlardarClient,ue as createSlardarClient};
