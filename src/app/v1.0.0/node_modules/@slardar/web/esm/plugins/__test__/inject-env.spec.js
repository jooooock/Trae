import test from 'ava';
import sinon from 'sinon';
import { createTestWebClient } from '../../__test__/util';
import { addEnvToSendEvent, InjectEnvPlugin } from '../inject-env';
var browserEnv = require('browser-env');
test.before(function () {
    browserEnv();
});
test('addEnvToSendEvent', function (t) {
    var ev = {
        ev_type: 'pageview',
        payload: {
            pid: 'init-pid',
            source: 'init',
        },
        extra: {
            url: 'origin url',
        },
    };
    t.like(addEnvToSendEvent(ev, { pid: '1', viewId: '2' }), {
        ev_type: 'pageview',
        payload: {
            pid: 'init-pid',
            source: 'init',
        },
        extra: {
            url: 'origin url',
            pid: '1',
            view_id: '2',
            sdk_version: '',
            sdk_name: 'SDK_SLARDAR_WEB',
        },
    });
});
test('InjectEnvPlugin', function (t) {
    var client = createTestWebClient();
    InjectEnvPlugin(client);
    var onReport = sinon.fake();
    client.on('report', onReport);
    client.init({
        bid: 'bid',
    });
    client.report({
        ev_type: 'pageview',
        payload: {
            pid: 'init-pid',
            source: 'init',
        },
        extra: {
            url: 'origin url',
        },
    });
    t.assert(onReport.calledOnce);
    t.like(onReport.args[0][0], {
        ev_type: 'pageview',
        payload: {
            pid: 'init-pid',
            source: 'init',
        },
        extra: {
            url: 'origin url',
            sdk_version: '',
            sdk_name: 'SDK_SLARDAR_WEB',
            pid: '',
        },
    });
});//# sourceMappingURL=https://trae.private/sourcemaps/424b4bd987c6c6a4cadf1a08da420593cc6bf75a/node_modules/@slardar/web/esm/plugins/__test__/inject-env.spec.js.map