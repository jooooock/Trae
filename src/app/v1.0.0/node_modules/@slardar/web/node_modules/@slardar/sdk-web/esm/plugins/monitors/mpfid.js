import { __assign } from "tslib";
import { initSubjectInGlobal, initPrivateSubject, registerTearDownGroup } from '@slardar/sdk-template';
import { applyFirstPV, FIRST_PV_SUBJECT_NAME } from '../../collector/client';
import { unloadSubject, loadSubject, activatedSubject } from '../../collector/page';
import { longtaskSubject } from '../../collector/perf';
import { PERFORMANCE_METRIC_EV_TYPE } from '../../constants';
import { MPFID } from '../../monitors/performance-new';
export var MPFID_MONITOR_PLUGIN_NAME = MPFID[0];
export function MPFIDMonitorPlugin(client) {
    client.on('init', function () {
        var getActivatedObserver = function () { return initSubjectInGlobal(client, activatedSubject); };
        var unloadObserver = initSubjectInGlobal(client, unloadSubject);
        var loadObserver = initSubjectInGlobal(client, loadSubject);
        var longtaskObserver = initSubjectInGlobal(client, longtaskSubject);
        var overrides = undefined;
        var firstPVObserver = initPrivateSubject(client, [FIRST_PV_SUBJECT_NAME, applyFirstPV(client)], -1);
        firstPVObserver[0](function (o) {
            overrides = o;
        })();
        var reportMetric = function (data) {
            // every first screen metrics needs to be associated with the context when client init
            client.report(__assign(__assign({}, data), { overrides: overrides }));
        };
        var tearDown = [];
        MPFID[1](reportMetric, tearDown, [loadObserver, getActivatedObserver, unloadObserver, longtaskObserver]);
        registerTearDownGroup(client, MPFID_MONITOR_PLUGIN_NAME, PERFORMANCE_METRIC_EV_TYPE, tearDown);
    });
}//# sourceMappingURL=https://trae.private/sourcemaps/424b4bd987c6c6a4cadf1a08da420593cc6bf75a/node_modules/@slardar/web/node_modules/@slardar/sdk-web/esm/plugins/monitors/mpfid.js.map