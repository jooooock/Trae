import ava from 'ava';
import * as Sinon from 'sinon';
import { getDataFromEvent } from '../resource-error/util';
var browserEnv = require('browser-env');
var test = ava;
test.before(function () {
    browserEnv();
});
test.beforeEach(function (t) {
    t.context.map = {};
    Sinon.restore();
    Sinon.stub(window, 'addEventListener').callsFake(function (event, cb) {
        t.context.map[event] = cb;
    });
});
test.afterEach(function () {
    Sinon.restore();
});
test('getDataFromEvent', function (t) {
    t.deepEqual(getDataFromEvent({}), undefined);
    t.deepEqual(getDataFromEvent({ target: {} }), undefined);
    t.deepEqual(getDataFromEvent({
        target: { href: 'https://www.toutiao.com/1.js', tagName: 'script' },
    }), {
        tagName: 'script',
        url: '',
        xpath: undefined,
    });
    t.deepEqual(getDataFromEvent({
        target: { href: 'https://www.toutiao.com/main.css', tagName: 'LINK' },
    }), {
        tagName: 'LINK',
        url: 'https://www.toutiao.com/main.css',
        xpath: undefined,
    });
    t.deepEqual(getDataFromEvent({
        target: { src: 'https://www.toutiao.com/main.css', tagName: 'LINK' },
    }), {
        tagName: 'LINK',
        url: '',
        xpath: undefined,
    });
    t.deepEqual(getDataFromEvent({
        target: {
            tagName: 'LINK',
            getAttribute: function (attr) {
                if (attr === 'href') {
                    return '/main.css';
                }
            },
        },
    }), {
        tagName: 'LINK',
        url: '/main.css',
        xpath: undefined,
    });
    t.deepEqual(getDataFromEvent({
        target: {
            tagName: 'LINK',
            getAttribute: function (attr) {
                if (attr === 'href') {
                    return 'https://www.toutiao.com/main.css';
                }
            },
        },
    }), {
        tagName: 'LINK',
        url: 'https://www.toutiao.com/main.css',
        xpath: undefined,
    });
    t.deepEqual(getDataFromEvent({
        target: {
            tagName: 'LINK',
            getAttribute: function (attr) {
                if (attr === 'href') {
                    return location.href;
                }
            },
        },
    }), {
        tagName: 'LINK',
        url: 'about:blank',
        xpath: undefined,
    });
});
test('getDataFromEvent - capture path', function (t) {
    var elem1 = {
        tagName: 'div',
        id: '123',
        className: '99',
        name: 'elem1',
        getAttribute: function (id) {
            return this[id];
        },
    };
    var elem2 = {
        tagName: 'LINK',
        href: 'https://www.toutiao.com',
        className: 'aaa',
        title: 'elem2',
        parentNode: elem1,
        getAttribute: function (id) {
            return this[id];
        },
    };
    t.deepEqual(getDataFromEvent({
        target: elem2,
    }, true), {
        tagName: 'LINK',
        url: 'https://www.toutiao.com',
        xpath: '#123 > link.aaa[title="elem2"]',
    });
});//# sourceMappingURL=https://trae.private/sourcemaps/424b4bd987c6c6a4cadf1a08da420593cc6bf75a/node_modules/@slardar/base/node_modules/@slardar/sdk-web/esm/monitors/__test__/resource-error.spec.js.map