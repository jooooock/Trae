"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ReadFileTool = void 0;
const tslib_1 = require("tslib");
const i_tool_1 = require("../../common/base/i-tool");
const enum_1 = require("../../typing/enum");
let ReadFileTool = class ReadFileTool extends i_tool_1.ITool {
    async run() {
        this._logger.info("read file...", JSON.stringify(this._input));
        const { filePath, startLine, endLine } = this._input;
        const lines = [];
        const fileStream = await this._ide.createWorkspaceReadStream(filePath);
        const rl = fileStream.split('\n');
        let lineNumber = 1;
        for await (const line of rl) {
            if (lineNumber >= startLine && lineNumber <= endLine) {
                lines.push(line);
            }
            lineNumber++;
        }
        // 通过 this._input 逐行读取文件
        return {
            lines: lines.map((l, i) => ({
                line: startLine + i,
                content: l,
            })),
        };
    }
};
exports.ReadFileTool = ReadFileTool;
exports.ReadFileTool = ReadFileTool = tslib_1.__decorate([
    (0, i_tool_1.ToolImpl)(enum_1.ToolType.READ_FILE)
], ReadFileTool);
